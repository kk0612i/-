# 生成三台主机的ssh-key并配置

## 0.完成前置操作

[创建Hadoop学习途中使用的用户并设置文件夹归属](创建Hadoop学习途中使用的用户并设置文件夹归属.md) 

[5.修改三台主机的主机名并映射hosts文件](修改三台主机的主机名并映射hosts文件.md) 

## 1.ssh基本语法：

> `ssh 主机ip`
> 

## 2.生成三台主机的sshkey并实现免密登录

> 当我们使用`scp` 命令或者`rsync` 命令进行传输文件的时候 每次都需要输入主机的密码很多的重复操作 **所以**为了减少频繁重复的操作 我们可以使用**shell脚本+ssh的方式来一劳永逸**
> 

**免密登录原理（图解）：**

![ssh免密登录原理图.png](ssh免密登录原理图.png)

> 文字描述：
> 
- 1.在A服务器上生成sshkey
    
    2.使用`shh-copy-id`命令将生成的公钥拷贝到指定的服务器上
    
    3.使用`ssh`  命令访问指定服务器 将数据使用A服务器的私钥进行加密
    
    4.接收到A服务器的数据后使用A**服务器的公钥进行解密**
    
    5.使用**A服务器的公钥进行加密**并将加密的数据返回给A服务器
    
    6.接收到B服务器加密后的数据后 **使用私钥进行解密**数据
    

> 当我们了解了免密登录的原理之后来**$实践操作一下吧！$**
> 
1. 使用xshell连接三台服务器
2. 点击工具>>选择发送键输入到>>选择已连接的会话（如图）
    
    ![image.png](xshell发送键输入到的位置.png)
    
3. `cd ~/.ssh` 进入当前用户的ssh文件夹中
4. 使用 `ssh-keygen -t rsa` 命令生成公钥与私钥(过程**一路回车**)（如图）

![image.png](生成ssh-key命令以及过程.png)

1. 使用`ssh-copy-id` 命令将公钥拷贝到各服务器上（如下列命令）

```bash
ssh-copy-id hadoop102
ssh-copy-id hadoop101
ssh-copy-id hadoop103
```

![image.png](拷贝ssh-key到各服务器上的命令及过程.png)

如图当生成`authorized_keys` 即完成了公钥的拷贝

![image.png](授权公钥文件内容.png)

1. 尝试再次连接是否需要输入密码进行连接
    
    如图不再需要密码进行连接
    
    ![image.png](ssh免密连接成功.png)
    

7.生成的文件介绍

| `id_rsa` | 生曾的私钥文件 |
| --- | --- |
| `id_rsa.pub` | 生成的公钥文件 |
| `authorized_keys` | 存放授权过的无密登录服务器公钥 |
| `known_hosts` | 记录ssh访问过计算机的公钥(public key) |

## 若遇到配置完成后任然需要密码则查看该页面内容解决

[ssh配置完密钥后任然需要密码](ssh配置完密钥后任然需要密码.md)